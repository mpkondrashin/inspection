name: Inspection Windows Build
on: [push]
permissions:
  contents: write
jobs:
    build:
      runs-on: windows-latest
      steps:
        - uses: actions/checkout@v2
        - name: Set up Go
          uses: actions/setup-go@v3

        #- name: Run Tests
        #  run: go test -v ./cmd/ginspection

        - name: Build GInspection for Windows
          run: go build ./cmd/ginspection
        
        - name: Build Inspection for Windows
          run: go build ./cmd/inspection
    
        - name: Pack for Windows
          uses: montudor/action-zip@v1
          #if: startsWith(github.ref, 'refs/tags/')
          with:
            args: zip -j "inspection_win64.zip" inspection.exe ginspection.exe README.md config_example.yaml
            #args: zip -j "inspection_win64_${{ github.ref_name }}.zip" inspection.exe  README.md config_example.yaml
    
        - name: Release
          uses: softprops/action-gh-release@v1
#           #if: startsWith(github.ref, 'refs/tags/')
          with:
            files: |
              inspection_win64.zip
      
      